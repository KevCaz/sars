<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Fit a multimodel SAR curve — sar_multi • sars</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Fit a multimodel SAR curve — sar_multi" />

<meta property="og:description" content="Construct a multimodel species-area relationship curve using
  information criterion weights and up to twenty SAR models." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/sars_ms.html">package manuscript</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/txm676/sars">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a multimodel SAR curve</h1>
    <small class="dont-index">Source: <a href='https://github.com/txm676/sars/blob/master/R/sar_multi.R'><code>R/sar_multi.R</code></a></small>
    <div class="hidden name"><code>sar_multi.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Construct a multimodel species-area relationship curve using
  information criterion weights and up to twenty SAR models.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sar_multi</span>(<span class='no'>data</span>, <span class='kw'>obj</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"power"</span>,
  <span class='st'>"powerR"</span>,<span class='st'>"epm1"</span>,<span class='st'>"epm2"</span>,<span class='st'>"p1"</span>,<span class='st'>"p2"</span>,<span class='st'>"expo"</span>,<span class='st'>"koba"</span>,
  <span class='st'>"mmf"</span>,<span class='st'>"monod"</span>,<span class='st'>"negexpo"</span>,<span class='st'>"chapman"</span>,<span class='st'>"weibull3"</span>,<span class='st'>"asymp"</span>,
  <span class='st'>"ratio"</span>,<span class='st'>"gompertz"</span>,<span class='st'>"weibull4"</span>,<span class='st'>"betap"</span>,<span class='st'>"heleg"</span>, <span class='st'>"linear"</span>), <span class='kw'>crit</span> <span class='kw'>=</span> <span class='st'>"Info"</span>,
  <span class='kw'>normaTest</span> <span class='kw'>=</span> <span class='st'>"lillie"</span>, <span class='kw'>homoTest</span> <span class='kw'>=</span> <span class='st'>"cor.fitted"</span>, <span class='kw'>neg_check</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>alpha_normtest</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>alpha_homotest</span> <span class='kw'>=</span> <span class='fl'>0.05</span>, <span class='kw'>confInt</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>ciN</span> <span class='kw'>=</span> <span class='fl'>100</span>,
  <span class='kw'>verb</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>A dataset in the form of a dataframe with two columns: the first
with island/site areas, and the second with the species richness of each
island/site.</p></td>
    </tr>
    <tr>
      <th>obj</th>
      <td><p>Either a vector of model names or a fit_collection object.</p></td>
    </tr>
    <tr>
      <th>crit</th>
      <td><p>The criterion used to compare models and compute the model
weights. The default <code>crit = "Info"</code> switches to AIC or AICc depending
on the number of data points in the dataset. For BIC, use <code>crit =
"Bayes"</code>.</p></td>
    </tr>
    <tr>
      <th>normaTest</th>
      <td><p>The test used to test the normality of the residuals of each
model. Can be any of "lillie" (Lilliefors Kolmogorov-Smirnov test; the
default), "shapiro" (Shapiro-Wilk test of normality), "kolmo"
(Kolmogorov-Smirnov test), or "none" (no residuals normality test is
undertaken).</p></td>
    </tr>
    <tr>
      <th>homoTest</th>
      <td><p>The test used to check for homogeneity of the residuals of
each model. Can be any of "cor.fitted" (a correlation of the residuals with
the model fitted values; the default), "cor.area" (a correlation of the
residuals with the area values), or "none" (no residuals homogeneity test
is undertaken).</p></td>
    </tr>
    <tr>
      <th>neg_check</th>
      <td><p>Whether or not a check should be undertaken to flag any
models that predict negative richness values.</p></td>
    </tr>
    <tr>
      <th>alpha_normtest</th>
      <td><p>The alpha value used in the residual normality test
(default = 0.05, i.e. any test with a P value &lt; 0.05 is flagged as failing
the test).</p></td>
    </tr>
    <tr>
      <th>alpha_homotest</th>
      <td><p>The alpha value used in the residual homogeneity test
(default = 0.05, i.e. any test with a P value &lt; 0.05 is flagged as failing
the test).</p></td>
    </tr>
    <tr>
      <th>confInt</th>
      <td><p>A logical argument specifying whether confidence intervals
should be calculated for the multimodel curve using bootstrapping.</p></td>
    </tr>
    <tr>
      <th>ciN</th>
      <td><p>The number of bootstrap samples to be drawn to calculate the
confidence intervals (if <code>confInt == TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>verb</th>
      <td><p>verbose (default: <code>verb == TRUE</code>).</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class "multi" and class "sars" with two elements. The first
  element ('mmi') contains the fitted values of the multimodel sar curve. The
  second element ('details') is a list with the following components:</p><ul>
<li><p>mod_names  Names of the models that were successfully
  fitted and passed any model check</p></li>
<li><p>fits  A fit_collection object
  containing the successful model fits</p></li>
<li><p>ic  The information criterion
  selected</p></li>
<li><p>norm_test  The residual normality test selected</p></li>
<li><p>homo_test  The residual homogeneity test selected</p></li>
<li><p>alpha_norm_test  The alpha value used in the residual normality
  test</p></li>
<li><p>alpha_homo_test  The alpha value used in the residual
  homogeneity test</p></li>
<li><p>ics  The information criterion values (e.g. AIC
  values) of the model fits</p></li>
<li><p>delta_ics  The delta information
  criterion values</p></li>
<li><p>weights_ics  The information criterion weights of
  each model fit</p></li>
<li><p>n_points   Number of data points</p></li>
<li><p>n_mods 
  The number of successfully fitted models</p></li>
<li><p>no_fit  Names of the
  models which could not be fitted or did not pass model checks</p></li>
</ul>

<p>The <code><a href='summary.sars.html'>summary.sars</a></code> function returns a more useful summary of
  the model fit results, and the <code><a href='plot.multi.html'>plot.multi</a></code> plots the
  multimodel curve.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The multimodel SAR curve is constructed using information criterion
  weights (see Burnham &amp; Anderson, 2002; Guilhaumon et al. 2010). If
  <code>obj</code> is a vector of n model names the function fits the n models to
  the dataset provided. A dataset must have four or more datapoints to fit
  the multimodel curve. If any models cannot be fitted they are removed from
  the multimodel SAR. If <code>obj</code> is a fit_collection object, any model
  fits in the collection which are NA are removed. In addition, if any other
  model checks have been selected (i.e. residual normality and heterogeneity
  tests, and checks for negative predicted richness values), these are
  undertaken and any model that fails the selected test(s) is removed from
  the multimodel SAR. The order of the additional checks inside the function
  is: normality of residuals, homogeneity of residuals, and a check for
  negative fitted values. Once a model fails one test it is removed and thus
  is not available for further tests. Thus, a model may fail multiple tests
  but the returned warning will only provide information on a single test.</p>
<p>The resultant models are then used to construct the multimodel SAR curve.
  For each model in turn, the model fitted values are multiplied by the
  information criterion weight of that model, and the resultant values are
  summed across all models (Burnham &amp; Anderson, 2002). Confidence intervals
  can be calculated (using <code>confInt</code>) around the multimodel averaged
  curve using the bootstrap procedure outlined in Guilhaumon et al (2010).The
  procedure transforms the residuals from the individual model fits and
  occasionally NAs / Inf values can be produced - in these cases, the model
  is removed from the confidence interval calculation (but not the multimodel
  curve itself). When several SAR models are used and the number of bootstraps
  (<code>ciN</code>) is large, generating the confidence intervals can take a long
  time.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Occasionally a model fit will converge and pass the model fitting
  checks (e.g. residual normality) but the resulting fit is nonsensical (e.g.
  a horizontal line with intercept at zero). Thus, it can be useful to plot
  the resultant 'multi' object to check the individual model fits. To re-run
  the <code>sar_multi</code> function without a particular model, simply remove it
  from the <code>obj</code> argument.</p>
<p>The generation of confidence intervals around the multimodel curve (using
  <code>confInt == TRUE</code>), may throw up errors that we have yet to come
  across. Please report any issues to the package maintainer.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Burnham, K. P., &amp; Anderson, D. R. (2002). Model selection and
  multi-model inference: a practical information-theoretic approach (2nd
  ed.). New-York: Springer.</p>
<p>Guilhaumon, F., Mouillot, D., &amp; Gimenez, O. (2010). mmSAR: an R-package for
  multimodel species-area relationship inference. Ecography, 33, 420-424.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>data</span>(<span class='no'>galap</span>)
<span class='co'>#attempt to construct a multimodel SAR curve using all twenty sar models</span>
<span class='no'>fit</span> <span class='kw'>&lt;-</span> <span class='fu'>sar_multi</span>(<span class='no'>galap</span>)</div><div class='output co'>#&gt; 
#&gt;  Now attempting to fit the 20 SAR models: 
#&gt;  
#&gt; ──  multi_sars ────────────────────────────────────────────── multi-model SAR ──
#&gt; → power    : ✔
#&gt; → powerR   : ✔
#&gt; → epm1     : ✔
#&gt; → epm2     : ✔
#&gt; → p1       : ✔
#&gt; → p2       : ✔
#&gt; → expo     : ✔
#&gt; → koba     : ✔
#&gt; → mmf      : ✔
#&gt; → monod    : ✔
#&gt; → negexpo  : ✔
#&gt; → chapman  : Warning: could not compute parameters statistics
#&gt; → weibull3 : ✔
#&gt; → asymp    : ✔
#&gt; → ratio    : ✔
#&gt; → gompertz : ✔
#&gt; → weibull4 : ✔
#&gt; → betap    : ✔
#&gt; → heleg    : ✔
#&gt; → linear   : ✔
#&gt; 
#&gt;  Model fitting completed - all models succesfully fitted. Now undertaking model validation checks. 
#&gt;  Additional models will be excluded if necessary: </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>4 models failed the residuals normality test and have been excluded from the multi SAR:</span>
#&gt; <span class='message'>Extended Power model 1, Asymptotic regression, Cumulative Weibull 4 par., Linear model</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>1 models have negative fitted values and have been excluded from the multi SAR:</span>
#&gt; <span class='message'>Exponential</span></div><div class='output co'>#&gt; 15 remaining models used to construct the multi SAR: 
#&gt;  Power, PowerR, Extended Power model 2, Persistence function 1, Persistence function 2, Kobayashi, MMF, Monod, Negative exponential, Chapman Richards, Cumulative Weibull 3 par., Rational function, Gompertz, Beta-P cumulative, Heleg(Logistic) 
#&gt; ────────────────────────────────────────────────────────────────────────────────</div><div class='input'><span class='fu'>summary</span>(<span class='no'>fit</span>)</div><div class='output co'>#&gt; 
#&gt; Sar_multi object summary: 
#&gt; 
#&gt; 15  models successfully fitted
#&gt; 
#&gt; The following models could not be fitted or were removed due to model checks:
#&gt; Extended Power model 1, Asymptotic regression, Cumulative Weibull 4 par., Linear model, Exponential 
#&gt; 
#&gt; Ranked models based on AICc  weights:
#&gt; 
#&gt;                        Model Weight    AICc    R2   R2a     Shape Asymptote
#&gt; 1       Negative_exponential  0.235 141.426 0.557 0.488 convex up      TRUE
#&gt; 2                      Monod  0.191 141.840 0.545 0.475 convex up      TRUE
#&gt; 3                  Kobayashi  0.127 142.667 0.521 0.447 convex up     FALSE
#&gt; 4                      Power  0.078 143.625 0.491 0.413 convex up     FALSE
#&gt; 5     Persistence_function_1  0.070 143.840 0.589 0.486 convex up     FALSE
#&gt; 6                   Gompertz  0.065 143.987 0.585 0.482   sigmoid      TRUE
#&gt; 7  Cumulative_Weibull_3_par.  0.041 144.918 0.561 0.451 convex up      TRUE
#&gt; 8           Chapman_Richards  0.038 145.062 0.557 0.446 convex up      TRUE
#&gt; 9          Rational_function  0.038 145.088 0.556 0.445 convex up      TRUE
#&gt; 10           Heleg(Logistic)  0.031 145.476 0.545 0.431 convex up      TRUE
#&gt; 11                       MMF  0.031 145.476 0.545 0.431 convex up      TRUE
#&gt; 12    Persistence_function_2  0.021 146.306 0.521 0.401   sigmoid     FALSE
#&gt; 13                    PowerR  0.015 146.877 0.503 0.379 convex up     FALSE
#&gt; 14    Extended_Power_model_2  0.015 146.923 0.502 0.377   sigmoid     FALSE
#&gt; 15         Beta-P_cumulative  0.002 150.612 0.522 0.349 convex up     FALSE</div><div class='input'><span class='fu'>plot</span>(<span class='no'>fit</span>)</div><div class='img'><img src='sar_multi-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># construct a multimodel SAR curve using a fit_collection object</span>
<span class='no'>s1</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sar_power.html'>sar_power</a></span>(<span class='no'>galap</span>)
<span class='no'>s2</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sar_expo.html'>sar_expo</a></span>(<span class='no'>galap</span>)
<span class='no'>s3</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='sar_koba.html'>sar_koba</a></span>(<span class='no'>galap</span>)
<span class='no'>ff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fit_collection.html'>fit_collection</a></span>(<span class='no'>s1</span>, <span class='no'>s2</span>, <span class='no'>s3</span>)
<span class='no'>fit2</span> <span class='kw'>&lt;-</span> <span class='fu'>sar_multi</span>(<span class='no'>galap</span>, <span class='kw'>obj</span> <span class='kw'>=</span> <span class='no'>ff</span>)</div><div class='output co'>#&gt; 
#&gt;  Now undertaking model validation checks. Additional models will 
#&gt;  be excluded if necessary: </div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>1 models have negative fitted values and have been excluded from the multi SAR:</span>
#&gt; <span class='message'>Exponential</span></div><div class='output co'>#&gt; 2 remaining models used to construct the multi SAR: 
#&gt;  Power, Kobayashi 
#&gt; ────────────────────────────────────────────────────────────────────────────────</div><div class='input'><span class='fu'>summary</span>(<span class='no'>fit2</span>)</div><div class='output co'>#&gt; 
#&gt; Sar_multi object summary: 
#&gt; 
#&gt; 2  models successfully fitted
#&gt; 
#&gt; The following model could not be fitted or was removed due to model checks:
#&gt; Exponential 
#&gt; 
#&gt; Ranked models based on AICc  weights:
#&gt; 
#&gt;       Model Weight    AICc    R2   R2a     Shape Asymptote
#&gt; 1 Kobayashi  0.617 142.667 0.521 0.447 convex up     FALSE
#&gt; 2     Power  0.383 143.625 0.491 0.413 convex up     FALSE</div><div class='input'>
<span class='co'># construct a multimodel SAR curve without conducting any model checks</span>
<span class='no'>fit3</span> <span class='kw'>&lt;-</span> <span class='fu'>sar_multi</span>(<span class='no'>galap</span>, <span class='kw'>normaTest</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>homoTest</span> <span class='kw'>=</span> <span class='st'>"none"</span>, <span class='kw'>neg_check</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</div><div class='output co'>#&gt; 
#&gt;  Now attempting to fit the 20 SAR models: 
#&gt;  
#&gt; ──  multi_sars ────────────────────────────────────────────── multi-model SAR ──
#&gt; → power    : ✔
#&gt; → powerR   : ✔
#&gt; → epm1     : ✔
#&gt; → epm2     : ✔
#&gt; → p1       : ✔
#&gt; → p2       : ✔
#&gt; → expo     : ✔
#&gt; → koba     : ✔
#&gt; → mmf      : ✔
#&gt; → monod    : ✔
#&gt; → negexpo  : ✔
#&gt; → chapman  : Warning: could not compute parameters statistics
#&gt; → weibull3 : ✔
#&gt; → asymp    : ✔
#&gt; → ratio    : ✔
#&gt; → gompertz : ✔
#&gt; → weibull4 : ✔
#&gt; → betap    : ✔
#&gt; → heleg    : ✔
#&gt; → linear   : ✔
#&gt; 
#&gt;  All models passed the model validation checks 
#&gt;  
#&gt; 20 remaining models used to construct the multi SAR: 
#&gt;  Power, PowerR, Extended Power model 1, Extended Power model 2, Persistence function 1, Persistence function 2, Exponential, Kobayashi, MMF, Monod, Negative exponential, Chapman Richards, Cumulative Weibull 3 par., Asymptotic regression, Rational function, Gompertz, Cumulative Weibull 4 par., Beta-P cumulative, Heleg(Logistic), Linear model 
#&gt; ────────────────────────────────────────────────────────────────────────────────</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Thomas J. Matthews, François Guilhaumon.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

